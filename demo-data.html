<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>OmniPack Demo</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="stylesheet" href="TemplateData/style.css">
    <link rel="stylesheet" href="responsiveMinimalTemplateStyles.css"/>
    <script src="Build/UnityLoader.js"></script>
    <script src="TemplateData/UnityProgress.js"></script>
    <script src="responsiveMinimalTemplateLoader.js"></script>
    <script>
        instantiateUnity("https://nativeroboticsstorage.blob.core.windows.net/builds/OmniPackWebGLDataTest.json");

        var configuration = {};

        function receiveMessageFromUnity(txt) {
            /*var dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(txt);
            var downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href",     dataStr);
            downloadAnchorNode.setAttribute("download", "PalletizingConfig.json");
            document.body.appendChild(downloadAnchorNode); // required for firefox
            downloadAnchorNode.click();
            downloadAnchorNode.remove();*/

            var rawConfig = JSON.parse(txt);

            //Removing useless fields from Unity's Vector3 implementation
            delete rawConfig.box.size.normalized;
            delete rawConfig.box.size.magnitude;
            delete rawConfig.box.size.sqrMagnitude;

            configuration = rawConfig;

            //Attaching new values to corresponding elements
            document.getElementById("robot-name").innerText = configuration.robot.name;
            document.getElementById("gripper-name").innerText = configuration.gripper.name;
            document.getElementById("box-length").innerText = configuration.box.size.z + " mm";
            document.getElementById("box-width").innerText = configuration.box.size.x + " mm";
            document.getElementById("box-height").innerText = configuration.box.size.y + " mm";
            document.getElementById("box-mass").innerText = configuration.box.mass + " gr";
        }

        function getData() {
            if (runtimeInitialized) {
                gameInstance.SendMessage("WebGLBridge", "GetPalletizingSettings");
            }
        }
    </script>
</head>
<body>
<div class="webgl-content">
    <div id="gameContainer" style="width: 100vw; height: 90vh"></div>
    <div class="footer">
        <div class="nr-logo">
            <object type="image/svg+xml" data="logo-webgl.svg"></object>
        </div>
        <div class="title">OmniPack</div>
        <div class="fullscreen">
            <div class = "title data-item">Box Length:
                <div id="box-length">Loading...</div>
            </div>
            <div class = "title data-item">Box Width:
                <div id="box-width">Loading...</div>
            </div>
            <div class = "title data-item">Box Height:
                <div id="box-height">Loading...</div>
            </div>
            <div class = "title data-item">Box Mass:
                <div id="box-mass">Loading...</div>
            </div>
            <div class = "title data-item">Robot:
                <div id="robot-name">Loading...</div>
            </div>
            <div class = "title data-item">Gripper:
                <div id="gripper-name">Loading...</div>
            </div>

            <div class="fullscreen-icon" onclick="gameInstance.SetFullscreen(1)">
                <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M23.625 17.5V23.625H17.5" stroke="#F5F5F5" stroke-width="2" stroke-linecap="round"
                          stroke-linejoin="round"/>
                    <path d="M23.0672 23.0655L16.625 16.625" stroke="#F5F5F5" stroke-width="2" stroke-linecap="round"
                          stroke-linejoin="round"/>
                    <path d="M4.375 10.5V4.375H10.5" stroke="#F5F5F5" stroke-width="2" stroke-linecap="round"
                          stroke-linejoin="round"/>
                    <path d="M4.93274 4.93451L11.3749 11.3751" stroke="#F5F5F5" stroke-width="2" stroke-linecap="round"
                          stroke-linejoin="round"/>
                    <path d="M17.5 4.375H23.625V10.5" stroke="#F5F5F5" stroke-width="2" stroke-linecap="round"
                          stroke-linejoin="round"/>
                    <path d="M23.0655 4.9328L16.625 11.375" stroke="#F5F5F5" stroke-width="2" stroke-linecap="round"
                          stroke-linejoin="round"/>
                    <path d="M10.5 23.625H4.375V17.5" stroke="#F5F5F5" stroke-width="2" stroke-linecap="round"
                          stroke-linejoin="round"/>
                    <path d="M4.93445 23.0672L11.375 16.625" stroke="#F5F5F5" stroke-width="2" stroke-linecap="round"
                          stroke-linejoin="round"/>
                </svg>
            </div>
        </div>
    </div>
</div>
</body>
</html>